<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<link rel="stylesheet" href="./../../../lib/font-awesome-4.7.0/css/font-awesome.css">
	<link rel="stylesheet" href="./../../../lib/element-ui/v2.4.1/theme-chalk/index.min.css">
	<link rel="stylesheet" href="./../../../src/css/main.css">
	<style>
		html,
		body {
			width: 100%;
		}

		#app {
			width: 100%;
			height: 100%;
			position: relative;
			overflow: hidden;
		}

		.content {
			height: calc(100% - 40px);
			overflow-y: auto;
			overflow-x: hidden;
		}

		.dialog-footer {
			background: #fff;
			width: 100%;
			position: absolute;
			bottom: 0px;
			z-index: 190;
			height: 40px;
			line-height: 40px;
		}

		.bulk {
			padding-bottom: 10px;
			margin-bottom: 22px;
			border-bottom: 1px solid rgb(228, 231, 237);
		}

		.title {
			padding: 0px 0px 10px 0px;
			height: 100%;
			border-bottom: 2px solid rgb(64, 158, 255);
		}

		.el-date-editor,
		.el-input-number {
			width: 100% !important;
			/*height: 31px;*/
		}

		.el-picker-panel {
			z-index: 3007 !important;
		}

		.el-input__inner {
			text-align: left !important;
		}

		.el-form-item {
			margin-bottom: 15px !important;
		}

		.el-radio-group {
			line-height: 46px !important;
		}

		.el-upload {
			width: 100% !important
		}

		.height {
			height: 56px;
		}

		.file-item {
			height: 30px;
			line-height: 30px;
			width: 100%;
			/*padding: 0px 10px*/
		}

		.file-item:hover {
			background: #dcdfe6
		}

		.btn {
			padding-left: 10px;
			cursor: pointer;
			font-size: 1.2em
		}

		.btn:hover {
			color: #66b1ff;
		}
	</style>
</head>

<body>
	<div id="app" v-cloak v-loading="isLoading">
		<div class="content">

			<el-form ref="formData" :model="formData" :label-width="labelwidth">
				<template v-for="group in formAttr">
					<div class="bulk" v-if="group.groupName">
						<span class="title" v-text="group.groupName">
						</span>
					</div>
					<el-row :gutter="10">
						<template v-for="item in group.data">

							<el-col v-if="item.type=='UT_13'" :xs="24" :sm="24" :md="24" :lg="24" :xl="24">
								<el-form-item :prop="item.id" :label="item.name" :rules="item.verify">
									<el-input v-if="item.type=='UT_13'" autosize type="textarea" :rows="2" :size="item.size" v-model="formData[item.id]" :disabled="item.disabled"></el-input>
								</el-form-item>
							</el-col>
							<el-col v-else :xs="formConfig.xs" :sm="formConfig.sm" :md="formConfig.md" :lg="formConfig.lg" :xl="formConfig.xl" :class="{'height' : item.type=='UT_14'||item.type=='UT_05'||item.type=='UT_06'||item.type=='UT_07'||item.type=='UT_08' }">
								<el-form-item :prop="item.id" :label="item.name" :rules="item.verify" initial="off">
									<el-input v-if="item.type=='UT_01'" :placeholder="item.placeholder" v-model="formData[item.id]" :size="item.size" :disabled="item.disabled"
									  clearable>
									</el-input>
									<el-select v-model="formData[item.id]" multiple v-if="isMultiSelect(item)" style="width:100%" :size="item.size" :disabled="item.disabled"
									  clearable @visible-change="visibleChange($event,item)" @change="getChildOpts($event,item)">
										<template v-for="option in item.options">
											<el-option :label="option.value" :value="option.key">
											</el-option>
										</template>
									</el-select>
									<el-select v-model="formData[item.id]" :disabled="item.disabled" v-if="isSelect(item)" style="width:100%" :size="item.size"
									  clearable @visible-change="visibleChange($event,item)" @change="getChildOpts($event,item)">
										<template v-for="option in item.options">
											<el-option :label="option.value" :value="option.key">
											</el-option>
										</template>
									</el-select>
									<el-time-picker v-if="item.type=='UT_02'" value-format="HH:mm:ss" :disabled="item.disabled" v-model="formData[item.id]" placeholder="任意时间点"
									  :size="item.size">
									</el-time-picker>
									<el-date-picker v-if="item.type=='UT_04'" value-format="yyyy-MM-dd HH:mm:ss" v-model="formData[item.id]" type="datetime"
									  placeholder="选择日期时间" :size="item.size" :disabled="item.disabled">
									</el-date-picker>
									<el-date-picker v-if="item.type=='UT_03'" value-format="yyyy-MM-dd" type="date" :placeholder="item.placeholder" v-model="formData[item.id]"
									  :size="item.size" :disabled="item.disabled" style="width: 100%;">
									</el-date-picker>
									<el-radio-group v-if="isRadio(item)" border v-model="formData[item.id]" size="small" :disabled="item.disabled">
										<template v-for="radioItem in item.options">
											<el-radio :label="radioItem.key" size="small">{{radioItem.value}}</el-radio>
										</template>
									</el-radio-group>
									<el-checkbox-group v-if="isCheckbox(item)" v-model="formData[item.id]" :disabled="item.disabled">
										<template v-for="checkboxItem in item.options">
											<el-checkbox :label="checkboxItem.key">{{checkboxItem.value}}</el-checkbox>
										</template>
									</el-checkbox-group>
									<el-input-number v-if="item.type=='UT_14'" :size="item.size" v-model="formData[item.id]" controls-position="right" :min="item.min"
									  :max="item.max"></el-input-number>
								</el-form-item>
							</el-col>
						</template>
					</el-row>
				</template>
				<el-row>
					<template v-if="ifAttachment">
						<el-upload multiple :limit="limitNum" :show-file-list="false" class="upload-demo" name="files" ref="upload" :action="actionURL"
						  :on-exceed="onExceed" :on-change="uploadOnChange" :on-success="onsuccess" :file-list="fileList" :auto-upload="autoUpload"
						  :on-progress="uploadOnProgress">
							<div class="bulk" style="text-align: left">
								<span class="title">
									<span>上传附件</span>
									<span style="padding-left:10px">{{fileListlength}}</span>
									<span style="padding-left:5px">—</span>
									<span style="padding-left:5px">{{limitNum}}</span>
								</span>
								<div style="float:right;font-size:18px;color:rgb(64, 158, 255)" slot="trigger" class="fa fa-upload" style="font-size:20px">
								</div>
							</div>
						</el-upload>
						<el-col :xs="24" :sm="24" :md="24" :lg="24" :xl="24">
							<div class="file-list">
								<div v-for="(item,key) in fileListStatus" :key="key" class="file-item">
									<div style="float:left">
										<i class="el-icon-document"> </i>
										<span style="padding-left:10px">{{item.name}}</span>
									</div>
									<div style="float:right">
										<i v-if="item.oid" class="el-icon-view btn" @click="handlePreview(item)"> </i>
										<i v-if="item.oid" class="el-icon-download btn" @click="handleDownload(item)"> </i>
										<i class="el-icon-delete btn" @click="handleFileRemove(item,key)"> </i>
									</div>
								</div>
								<div v-if="!pass && progress !== 0" class="file-item img-progress">
									<el-progress :percentage="progress" :status="proStatus"></el-progress>
								</div>
							</div>
						</el-col>
					</template>

				</el-row>
			</el-form>
		</div>
		<div slot="footer" class="dialog-footer" style="text-align: center">
			<el-button size="small" @click="cancel()">取 消</el-button>
			<el-button size="small" type="primary" @click="submit('formData')">确 定</el-button>
		</div>
	</div>
</body>
<script src="./../../../lib/jquery/jquery-1.12.4.min.js"></script>
<script src="./../../../lib/vue/vue.js"></script>
<script src="./../../../lib/element-ui/v2.4.1/index.min.js"></script>
<script src="./../../../common/components/jas-components.js "></script>
<script src="./../../../common/js/jas-tools.js"></script>
<!--<script src="js/ajaxFileUpload.js"></script>-->
<script>
	var app = new Vue({
		el: "#app",
		data: function () {
			return {
				isLoading: true,
				rules: [],
				formData: {}, // 表单字段详情对象
				formAttr: [], // 表单字段，分组排序，配置数组
				// [{
				// 	groupName: '分组名',
				// 	data: that._sortArray(groupAttr)
				// }]
				labelwidth: "100",
				formConfig: {
					xs: 24,
					sm: 12,
					md: 6,
					lg: 6,
					xl: 6
				},
				fileListlength: 0,
				menuCode: "",
				formDetail: {},
				fileList: [],
				fileListStatus: [],
				pkArray: [],
				ifAttachment: false,
				progress: 0, //上传进度
				pass: null, //是否上传成功
				limitNum: 2,
				autoUpload: false,
				actionURL: jasTools.base.rootPath + "/attachment/upload.do?token=" + localStorage.getItem("token"),
			}
		},
		computed: {
			proStatus: function () { //上传状态
				if (this.pass) {
					return 'success';
				} else if (this.pass == false) {
					return 'exception';
				} else {
					return '';
				}
			}
		},
		mounted: function () {
			var param = window.jasTools.base.getParamsInUrl(location.href);
			if (param.menuCode) {
				this.menuCode = param.menuCode;
			}
			delete param.menuCode;
			this.formDetail = param;
			this.isAddPage = JSON.stringify(this.formDetail) == '{}'; // 根据URL中传入的数据判断该页面是否处于编辑页面
			this.requestConfig();
			this.requestRule();
			this.requestFieldConfigByOid();
			if (!this.isAddPage) {
				this.requestDetailByObj(); //请求表单详情
			}
		},
		methods: {
			requestConfig: function () {
				var that = this;
				$.ajax({
					type: "get",
					url: "../js/template.json",
					dataType: "json",
					async: true,
					success: function (data) {
						if (data.form.col) {
							that.setConfig(data.form.col);
							that.labelwidth = data.form.labelwidth;
						}
						that.autoUpload = data.file.autoUpload;
						that.limitNum = data.file.limitNum;
					}
				});
			},
			requestRule: function () { //显示请求规则，成功之后再去请求所有的
				var that = this;

				$.ajax({
					type: "get",
					url: "../../form-operation/js/regexp.json",
					dataType: "json",
					async: true,
					success: function (data) {
						if (data.rows) {
							that.rules = data.rows;
						}
					}
				});
			},
			requestFieldConfigByOid: function () { // 获取各个字段的配置信息
				var that = this;
				var url = jasTools.base.rootPath + "/functionConfiguration/getDetailByCode.do";
				jasTools.ajax.get(url, {
					functionCode: that.menuCode
				}, function (data) {
					that.isLoading = false;
					that.ifAttachment = !!(data.data.ifAttachment == 1); //是否存在附件
					var fieldsGrouped = that._formatFieldsByGroup(data.data.functionFieldsBoList);
					if (that.isAddPage) {
						that.getAddField(fieldsGrouped);
					} else {
						that.getEditField(fieldsGrouped);
					}
				})
			},
			_formatFieldsByGroup: function (aFields) { // 将字段进行分组格式化
				var map = {};
				var dest = [];
				for (var i = 0; i < aFields.length; i++) {
					var ai = aFields[i];
					if (!map[ai.groupIndex || ai.groupName]) {
						dest.push({
							groupName: ai.groupName,
							index: ai.groupIndex || '',
							data: [ai]
						});
						map[ai.groupIndex || ai.groupName] = ai;
					} else {
						for (var j = 0; j < dest.length; j++) {
							var dj = dest[j];
							if ((dj.index == ai.groupIndex) || (dj.groupName == ai.groupName)) {
								dj.data.push(ai);
								break;
							}
						}
					}

				}
				return this._sortArray(dest);
			},
			getAddField: function (data) {
				var that = this;
				data.forEach(function (group, index) { // 针对组数进行循环
					var groupAttr = [];
					group.data.forEach(function (item) { // 针对组内的每一项进行循环
						var obj = {};
						var options = [];
						if (item.ifPrimaryKey) { // 找出oid的字段，创建uuid
							that.pkArray.push(item.fieldName);
							that.formData[item.fieldName] = jasTools.base.createuuid();
						}
						if (item.domainList) { // 字段是阈值下拉选的
							item.domainList.forEach(function (child) {
								var obj = {};
								for (var key in child) {
									obj[key.toLowerCase()] = child[key];
								}
								options.push(obj);
							});
						}
						if (item.ifSave == '1') { //
							obj = {
								id: item.fieldName,
								name: item.fieldNameCn,
								type: item.uiType,
								size: "small",
								placeholder: item.placeholder,
								options: options,
								verify: [],
								requestUrl: item.requestPath,
								childField: item.childField,
								min: item.min || -Infinity,
								max: item.max || Infinity,
								index: item.rowIndex,
							};
							if (item.ifRequired == '1') {
								obj.verify.push({
									required: true,
									message: item.placeholder || '该字段为必填项',
									// trigger: 'blur'
								});

							}
							if (item.uiType == 'UT_01') { // 文本域
								that.rules.forEach(function (ruleItem) {
									if (ruleItem.id == item.regularExpression) {
										obj.verify.push({
											pattern: eval(ruleItem.regexp),
											message: ruleItem.tip
										});
									}
								});
							}
							if (item.fieldLength && item.uiType == 'UT_01') { // 添加长度限制
								obj.verify.push({
									min: "0",
									max: item.fieldLength,
									message: "不能超过" + item.fieldLength + "字"
								});
							}
							if (item.regularExpression == '4' && item.min && item.max) {
								obj.verify.push({
									validator: validateNumber,
									trigger: 'blur'
								});
							}
							if (item.uiType == "UT_07" || item.uiType == "UT_08") {
								that.$set(that.formData, item.fieldName, []);
							}
							if (item.uiType == "UT_05" || item.uiType == "UT_06") {
								if (obj.options.length > 0) {
									that.$set(that.formData, item.fieldName, obj.options[0].key);
								}
							}
							groupAttr.push(obj);
						}
					});
					that.formAttr.push({
						groupName: group.groupName,
						data: that._sortArray(groupAttr)
					});
				});
				that.actionURL = jasTools.base.rootPath + "/attachment/upload.do?token=" + localStorage.getItem("token") +
					"&businessId=" +
					that.formData[that.pkArray[0]] + "&businessType=file";
			},
			getEditField: function (data) {
				var that = this;
				data.forEach(function (group, index) {
					var groupAttr = [];
					group.data.forEach(function (item) {
						var obj = {};
						var options = [];
						if (item.ifPrimaryKey) {
							that.pkArray.push(item.fieldName);
						}
						if (item.domainList) {
							item.domainList.forEach(function (child) {
								var obj = {};
								for (var key in child) {
									obj[key.toLowerCase()] = child[key];
								}
								options.push(obj);
							});
						}
						if (item.ifUpdate == '1') {
							obj = {
								id: item.fieldName,
								name: item.fieldNameCn,
								type: item.uiType,
								size: "small",
								placeholder: item.placeholder,
								options: options,
								verify: [],
								requestUrl: item.requestPath,
								childField: item.childField,
								index: item.rowIndex,
								min: item.min || -Infinity,
								max: item.max || Infinity,
								disabled: false
							};
							if (item.updateable == '1') {
								obj.disabled = true;
							}
							if (item.ifRequired == '1') {
								obj.verify.push({
									required: true,
									message: item.placeholder
								});
							}
							if (item.uiType == 'UT_01') {
								that.rules.forEach(function (ruleItem) {
									if (ruleItem.id == item.regularExpression) {
										obj.verify.push({
											pattern: eval(ruleItem.regexp),
											message: ruleItem.tip
										});
									}
								});
							}
							if (item.fieldLength && item.uiType == 'UT_01') {
								obj.verify.push({
									min: "0",
									max: item.fieldLength,
									message: "不能超过" + item.fieldLength + "字"
								});
							}
							if (item.uiType == 'UT_04' || item.uiType == 'UT_03' || item.uiType == 'UT_02') {
								that.formData[item.fieldName] = new Date(that.formData[item.fieldName]);
							}
							if (item.regularExpression == '4' && item.min && item.max) {
								obj.verify.push({
									validator: validateNumber,
									trigger: 'blur'
								});
							}
							if (item.uiType == "UT_07" || item.uiType == "UT_08") {
								that.$set(that.formData, item.fieldName, that.formData[item.fieldName].split(","));
							}
							if (item.uiType == "UT_09" || item.uiType == "UT_10") {
								that.$set(that.formData, item.fieldName, that.formData[item.fieldName].split(","));
							}
							groupAttr.push(obj);
						}
					});
					that.formAttr.push({
						groupName: group.groupName,
						data: that._sortArray(groupAttr)
					});
				});

				that.requestFiles();
				that.actionURL = jasTools.base.rootPath + "/attachment/upload.do?token=" + localStorage.getItem("token") +
					"&businessId=" + that.formData[that.pkArray[0]] + "&businessType=file";
			},
			requestFiles: function () {
				var that = this;
				var url = jasTools.base.rootPath + "/attachment/getInfo.do";
				jasTools.ajax.get(url, {
					businessType: 'file',
					businessId: that.formData[that.pkArray[0]]
				}, function (data) {
					data.rows.forEach(function (item) {
						var file = {
							name: item.fileName,
							size: item.size,
							oid: item.oid
						};
						that.fileList.push(file);
						that.fileListStatus.push(file);
					});
					that.fileListlength = that.fileList.length;
				});
			},
			requestDetailByObj: function () { //请求表单详情
				var that = this;
				var url = jasTools.base.rootPath + "/map/commonData/" + that.menuCode + "/get.do";
				//该接口需要入参主键，因为主键不确定，所以全部传入表单对象
				jasTools.ajax.post(url, this.formDetail, function (data) {
					that.formData = data.data;
				});
			},
			cancel: function () {
				this.closeForm();
			},
			closeForm: function () {
				top.jasTools.dialog.close();
			},
			submit: function (formName) {
				var that = this;
				this.$refs[formName].validate(function (valid) {
					if (valid) {
						that.submitToServer();
					} else {
						return false;
					}
				});
			},
			submitToServer: function () {
				var that = this;
				var url = "";
				var msg = "";
				/*属性里面是数组的进行转换成字符串*/
				for (key in that.formData) {
					if (that.formData[key] instanceof Array) {
						that.formData[key] = that.formData[key].join(",")
					}
				}
				if (that.autoUpload) {
					that.saveInfo();
				} else {
					var isNotFile = true;
					that.fileListStatus.forEach(function (item) { // 文件有oid代表已经在服务器上了，无需上传
						if (!item.oid) {
							isNotFile = false;
							return;
						}
					});
					if (isNotFile) {
						that.requestDeleteFiles(function () {
							that.saveInfo();
						});
					} else {
						that.actionURL = jasTools.base.rootPath + "/attachment/upload.do?token=" + localStorage.getItem("token") +
							"&businessId=" +
							that.formData[that.pkArray[0]];
						that.$refs.upload.submit();
					}
				}
			},
			onsuccess: function (e, file) {
				var that = this;
				that.pass = true;
				top.Vue.prototype.$message.success("上传成功");
				that.fileList.push({
					name: file.name,
					size: file.size,
				});
				if (!that.autoUpload) {
					that.requestDeleteFiles(function () {
						that.saveInfo();
					});
				}
			},
			saveInfo: function () {
				var that = this;
				var str = that.isAddPage ? "save" : "update";
				var url = jasTools.base.rootPath + "/map/commonData/" + that.menuCode + "/" + str + ".do"
				jasTools.ajax.post(url, that.formData, function () {
					top.Vue.prototype.$message({
						message: that.isAddPage ? "增加成功" : "修改成功",
						type: 'success'
					});
					that.closeForm();
				});
			},
			handleFileRemove: function (file, i) {
				var that = this;
				top.Vue.prototype.$confirm('删除附件, 是否继续?', '提示', {
					confirmButtonText: '确定',
					cancelButtonText: '取消',
					type: 'warning',
					callback: function (status) {

						if (status === 'confirm') {

							that.fileList.splice(i, 1);
							that.fileListStatus.splice(i, 1);
							that.fileListlength = that.fileListStatus.length;

							if (file.oid) {
								// that.requestDeleteFiles(file);
								if (that.filesToBeDelete) {
									that.filesToBeDelete.push(file.oid)
								} else {
									that.filesToBeDelete = [file.oid]
								}
							} else {
								top.Vue.prototype.$message({
									message: '删除成功',
									type: 'success'
								});
							}

						}
					}
				});
			},
			requestDeleteFiles: function (cb) {
				var that = this;
				if (!that.filesToBeDelete) {
					cb && cb();
					return;
				}
				jasTools.ajax.get(jasTools.base.rootPath + "/attachment/delete.do", {
					oids: that.filesToBeDelete.join(',')
				}, function (data) {
					cb && cb();
					// top.Vue.prototype.$message({
					// 	message: '删除成功',
					// 	type: 'success'
					// });
				});
			},
			handlePreview: function (file) {
				window.top.jasTools.dialog.show({
					title: '预览',
					width: '90%',
					height: '90%',
					src: "./pages/template/pdfjs_1.10.88/web/viewer.html?oid=" + file.oid,
				});
			},
			uploadOnChange: function (file, fileList) { //文件状态改变时的钩子，添加文件、上传成功和上传失败时都会被调用
				// console.log("——————————change——————————")
				// console.log(file);
				var that = this;
				that.fileListlength = fileList.length;
				if (file.status == 'ready') {
					this.pass = null;
					this.progress = 0;
					this.fileListStatus.push({
						name: file.name,
						size: file.size
					})
				} else if (file.status == 'fail') {
					this.$message.error("上传出错，请刷新重试！")
				}
			},
			uploadOnProgress: function (e, file) { //开始上传
				this.progress = Math.floor(e.percent)
			},
			handleDownload: function (file) {
				var that = this;
				jasTools.ajax.downloadByIframe('post', jasTools.base.rootPath + "/attachment/download.do", {
					oid: file.oid
				});
			},
			onExceed: function (files, fileList) {
				var that = this;
				top.Vue.prototype.$message({
					message: '文件最多上传' + that.limitNum,
					type: 'info'
				});
			},
			getChildOpts: function (value, item) {
				var that = this;

				var formatFormAttr = function (options) {
					that.formAttr.forEach(function (parent, index) {
						parent.data.forEach(function (child) {
							console.log("_________",item.childField)
							if (item.childField.indexOf(child.id) !== -1) {
								if (value) {
									child.options = options;
								} else {
									child.options = [];
								}
								that.$set(that.formData, item.childField, "");
							}
						});
					});
				};

				if (item.requestUrl && value) { //进行子级的查找 后台请求
					var key = jasTools.base.switchToCamelCase(item.id);
					var obj = {
						"rows": 100,
						"page": 1,
					};
					obj[key] = value;
					jasTools.ajax.post(jasTools.base.rootPath + "/" + item.requestUrl, obj, function (data) {
						// data.rows.forEach(function (item) {
						// 	var obj = {
						// 		"key": item.fieldName,
						// 		"value": item.fieldName,
						// 	};
						// 	options.push(obj);
						// });
						formatFormAttr(data.rows)
					});
				} else {
					formatFormAttr([]);
				}
			},
			visibleChange: function (falg, item) {
				var that = this;
				if (falg) {
					that.formAttr.forEach(function (parent, index) {
						parent.data.forEach(function (child) {
							if (child.childField == item.id) {
								if (!that.formData[child.id]) {
									top.Vue.prototype.$message({
										message: '请先选择' + child.name,
										type: 'warning'
									});
								}
								return;
							}
						})
					});
				}
			},
			setConfig: function (col) {
				if (col == 4) {
					this.formConfig.xs = 24;
					this.formConfig.sm = 12;
					this.formConfig.md = 6;
					this.formConfig.lg = 6;
					this.formConfig.xl = 6;
				}
				if (col == 3) {
					this.formConfig.xs = 24;
					this.formConfig.sm = 12;
					this.formConfig.md = 8;
					this.formConfig.lg = 8;
					this.formConfig.xl = 8;
				}
				if (col == 2) {
					this.formConfig.xs = 24;
					this.formConfig.sm = 12;
					this.formConfig.md = 12;
					this.formConfig.lg = 12;
					this.formConfig.xl = 12;
				}
				if (col == 1) {
					this.formConfig.xs = 24;
					this.formConfig.sm = 24;
					this.formConfig.md = 24;
					this.formConfig.lg = 24;
					this.formConfig.xl = 24;
				}
			},
			isSelect: function (item) {
				if (item.type == "UT_11" || item.type == "UT_12") {
					return true;
				}
				return false;
			},
			isMultiSelect: function (item) {
				if (item.type == "UT_09" || item.type == "UT_10") {
					return true;
				}
				return false;
			},
			isRadio: function (item) {
				if (item.type == "UT_05" || item.type == "UT_06") {
					return true;
				}
				return false;
			},
			isCheckbox: function (item) {
				if (item.type == "UT_07" || item.type == "UT_08") {
					return true;
				}
				return false
			},

			_sortArray: function (arry) { // 数组冒泡排序
				for (var unfix = arry.length - 1; unfix > 0; unfix--) {
					for (var i = 0; i < unfix; i++) {
						if (arry[i].index > arry[i + 1].index) {
							var temp = arry[i];
							arry.splice(i, 1, arry[i + 1]);
							arry.splice(i + 1, 1, temp);
						}
					}
				}
				return arry;
			}
		},
	});
	var validateNumber = function (rule, value, callback) {
		app.formAttr.forEach(function (parent) {
			parent.data.forEach(function (item) {
				if (item.id == rule.field) {
					if (value < item.min) {
						callback(new Error("值不能小于" + item.min));
					} else if (value > item.max) {
						callback(new Error("值不能大于" + item.max));
					} else {
						callback();
					}
					return
				}
			});
		});
	}
</script>

</html>